# =====================================
# E4C Complete Data Model - NGSI-LD Standard
# =====================================
# Version: 1.0.0
# Description: Complete E4C electric vehicle charging system data models

openapi: 3.0.0
info:
  title: E4C Electric Vehicle Charging System Data Models
  version: 1.0.0
  description: NGSI-LD data models for electric vehicle charging infrastructure

paths: {}

components:
  schemas:
    ChargingStation:
      description: E4C charging station that contains multiple charging points for electric vehicles - static configuration data
      # allOf:
      #   - $ref: "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
      #   - $ref: "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/Location-Commons"
      type: object
      properties:
        # NGSI-LD Required Properties
        id:
          anyOf:
            - description: Identifier format of any NGSI-LD entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI-LD entity as URI
              format: uri
              type: string
          description: Unique identifier of the charging station entity
          x-ngsi:
            type: Property
        
        type:
          type: string
          enum:
            - ChargingStation
          description: NGSI-LD Entity type. It must be ChargingStation
          x-ngsi:
            type: Property

        # Standard Common Properties   
        dateCreated:
          description: Entity creation timestamp. This will usually be allocated by the storage platform
          format: date-time
          type: string
          x-ngsi:
            type: Property
          
        # Timestamps
        lastUpdated:
          description: Timestamp when data was last updated
          format: date-time
          type: string
          x-ngsi:
            model: https://schema.org/DateTime
            type: Property
        
        # Basic Station Information
        stationName:
          type: string
          description: Name of the charging station
          x-ngsi:
            type: Property
            model: http://schema.org/Text
        
        stationId:
          type: string
          description: External identifier or code for the station
          x-ngsi:
            type: Property
            model: http://schema.org/Text

        # Geojson
        location:
          description: 'Geojson reference to the item. Point location only'
          properties:
            bbox:
              items:
                type: number
              minItems: 4
              type: array
            coordinates:
              items:
                type: number
              minItems: 2
              type: array
            type:
              enum:
                - Point
              type: string
          required:
            - type
            - coordinates
          title: GeoJSON Point
          type: object
          x-ngsi:
            type: GeoProperty
        
        # Capacity Configuration
        totalChargingPoints:
          type: integer
          minimum: 1
          description: Total number of charging points installed in this station
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        # Technical Specifications
        maxPowerCapacity:
          type: number
          minimum: 0
          description: Maximum total power capacity of the station in kW
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: kW
        
        ratedVoltage:
          type: number
          minimum: 0
          description: The rated voltage offered by the charging station in Volts
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: V
        
        gridConnection:
          type: string
          enum:
            - lowVoltage
            - mediumVoltage
            - highVoltage
            - directCurrent
          description: Type of electrical grid connection
          x-ngsi:
            type: Property
            model: http://schema.org/Text
        
        # Socket Types Available
        socketType:
          type: array
          items:
            type: string
            enum:
              - Type1
              - Type2
              - CHAdeMO
              - CCS_Combo1
              - CCS_Combo2
              - Tesla_Supercharger
              - Tesla_Destination
              - GB_T_AC
              - GB_T_DC
              - Schuko
              - CEE
              - Caravan_Mains_Socket
              - Wall_Euro
              - Other
          minItems: 1
          uniqueItems: true
          description: Types of charging sockets/connectors available at this station
          x-ngsi:
            type: Property
            model: http://schema.org/Text
        
        # Relationships to Other Entities
        refChargingPoints:
          type: array
          items:
            type: string
            format: uri
          description: References to charging points in this station
          x-ngsi:
            type: Relationship
            model: http://schema.org/URL
        
        refStationStatus:
          type: string
          format: uri
          description: Reference to real-time station status information
          x-ngsi:
            type: Relationship
            model: http://schema.org/URL
      
      required:
        - id
        - type
        - stationName
        - totalChargingPoints
        - socketType

    ChargingStationStatus:
      description: Real-time operational status and dynamic data for E4C charging station
      # allOf:
      #   - $ref: "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
      type: object
      properties:
        # NGSI-LD Required Properties
        id:
          anyOf:
            - description: Identifier format of any NGSI-LD entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI-LD entity as URI
              format: uri
              type: string
          description: Unique identifier of the charging station status entity
          x-ngsi:
            type: Property
        
        type:
          type: string
          enum:
            - ChargingStationStatus
          description: NGSI-LD Entity type. It must be ChargingStationStatus
          x-ngsi:
            type: Property
        
        # Reference to Parent Station
        refChargingStation:
          type: string
          format: uri
          description: Reference to the charging station this status belongs to
          x-ngsi:
            type: Relationship
            model: http://schema.org/URL

        # Standard Common Properties   
        dateCreated:
          description: Entity creation timestamp. This will usually be allocated by the storage platform
          format: date-time
          type: string
          x-ngsi:
            type: Property

        # Operational Status
        operationalStatus:
          type: string
          enum:
            - operational
            - outOfService
            - maintenance
          description: Overall operational status of the charging station
          x-ngsi:
            type: Property
            model: http://schema.org/Text
        
        # Point Availability Information
        totalPoints:
          type: integer
          minimum: 0
          description: Total number of charging points in the station
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        availablePoints:
          type: integer
          minimum: 0
          description: Number of currently available charging points
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        occupiedPoints:
          type: integer
          minimum: 0
          description: Number of occupied charging points
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        faultedPoints:
          type: integer
          minimum: 0
          description: Number of faulted charging points
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        maintenancePoints:
          type: integer
          minimum: 0
          description: Number of points under maintenance
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        reservedPoints:
          type: integer
          minimum: 0
          description: Number of reserved charging points
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        # Power and Energy Information (Enhanced with Grid/Renewable Separation)
        currentPowerConsumption:
          type: number
          minimum: 0
          description: Current total power consumption of all active units in kW
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: kW
        
        currentGridPowerConsumption:
          type: number
          minimum: 0
          description: Current power consumption from electrical grid in kW
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: kW
        
        currentRenewablePowerConsumption:
          type: number
          minimum: 0
          description: Current power consumption from renewable energy sources in kW
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: kW
        
        # Session Statistics
        activeSessionsCount:
          type: integer
          minimum: 0
          description: Number of currently active charging sessions
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        # Queue and Wait Time Information
        queueLength:
          type: integer
          minimum: 0
          description: Number of vehicles waiting in queue
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        estimatedWaitTime:
          type: integer
          minimum: 0
          description: Estimated wait time for next available unit in minutes
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: minutes
        
        # Environmental Conditions
        ambientTemperature:
          type: number
          description: Current ambient temperature in Celsius
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: Celsius
        
        humidity:
          type: number
          minimum: 0
          maximum: 100
          description: Current relative humidity in percentage
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: percent
        
        weatherConditions:
          type: string
          enum:
            - clear
            - cloudy
            - rainy
            - snowy
            - stormy
            - windy
            - foggy
          description: Current weather conditions
          x-ngsi:
            type: Property
            model: http://schema.org/Text
        
        # Grid and Power Quality
        gridVoltage:
          type: number
          minimum: 0
          description: Current grid voltage in Volts
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: V
        
        gridFrequency:
          type: number
          minimum: 0
          description: Current grid frequency in Hz
          x-ngsi:
            type: Property
            model: http://schema.org/Number
            units: Hz
        
        powerFactor:
          type: number
          minimum: 0
          maximum: 1
          description: Current power factor
          x-ngsi:
            type: Property
            model: http://schema.org/Number
        
        # Maintenance Information
        lastMaintenanceDate:
          type: string
          format: date-time
          description: Timestamp of last maintenance performed
          x-ngsi:
            type: Property
        
        nextScheduledMaintenance:
          type: string
          format: date-time
          description: Next scheduled maintenance timestamp
          x-ngsi:
            type: Property
      
      required:
        - id
        - type
        - refChargingStation
        - dateCreated    
        - totalPoints
        - availablePoints

      
      # # Metadata
      # x-derived-from: "Smart Data Models - Transportation"
      # x-disclaimer: "Redistribution and use in source and binary forms, with or without modification, are permitted provided that the license conditions are met. Copyleft (c) 2024 Contributors to Smart Data Models Program"
      # x-license-url: "https://github.com/smart-data-models/dataModel.Transportation/blob/master/LICENSE.md"
      # x-model-schema: "https://smart-data-models.github.io/dataModel.Transportation/ChargingStationStatus/schema.json"
      # x-model-tags: "NGSI-LD, EV, Charging, Transportation, Status, Real-time"
      # x-version: "1.0.0"

    ChargingPoint:
      description: 'An E4C charging point within a charging station, containing static configuration and specification data'
      # allOf:
      #   - $ref: "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
      type: object
      properties:
        # NGSI-LD Required Properties
        id:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Unique identifier of the charging point entity
          x-ngsi:
            type: Property
        
        type:
          description: NGSI Entity type. It has to be ChargingPoint
          enum:
            - ChargingPoint
          type: string
          x-ngsi:
            type: Property
        
        # Standard Common Properties
        dateCreated:
          description: Entity creation timestamp. This will usually be allocated by the storage platform
          format: date-time
          type: string
          x-ngsi:
            type: Property
                    
        # Timestamps
        lastUpdated:
          description: Timestamp when data was last updated
          format: date-time
          type: string
          x-ngsi:
            model: https://schema.org/DateTime
            type: Property
        
        # Relationship to Parent Station
        refChargingStation:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to the charging station this point belongs to
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship
        
        # Point Basic Information
        pointId:
          description: External point identifier from charging management system
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        # Physical Specifications
        chargingType:
          description: Type of charging supported by this point
          enum:
            - AC-Level1
            - AC-Level2
            - DC-FastCharging
            - bidirectional
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        connectorTypes:
          description: Types of connectors available on this point
          items:
            enum:
              - CCS1
              - CCS2
              - CHAdeMO
              - Type1
              - Type2
              - Tesla
              - GBT
              - NACS
              - Schuko
              - CEE
            type: string
          type: array
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        numberOfConnectors:
          description: Number of connectors on this point
          minimum: 1
          type: integer
          x-ngsi:
            model: https://schema.org/Number
            type: Property
                
        powerCapabilities:
          description: Detailed power capabilities of the point
          properties:
            maxACPower:
              description: Maximum AC power output in kW
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kW
            maxDCPower:
              description: Maximum DC power output in kW
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kW
            maxVoltage:
              description: Maximum output voltage in V
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: V
            maxCurrent:
              description: Maximum output current in A
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: A
            phases:
              description: Number of electrical phases (1 or 3)
              enum:
                - 1
                - 3
              type: integer
              x-ngsi:
                model: https://schema.org/Number
                type: Property
          type: object
          x-ngsi:
            model: https://schema.org/Object
            type: Property
        
        refSession:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to current charging session if point is in use
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship

        refChargingPointStatus:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to the PointStatus 
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship
          
        # Communication and Connectivity 
        communicationProtocol:
          description: Communication protocol used by the point
          enum:
            - OCPP1.6
            - OCPP2.0
            - OCPP2.0.1
            - ISO15118
            - proprietary
            - other
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property

      required:
        - id
        - type
        - refChargingStatio
        - chargingType
        - connectorTypes
        - maxPowerOutput

    ChargingPointStatus:
      description: 'Real-time operational status and dynamic data for E4C charging point, including current status, operating parameters, and monitoring information'
      # allOf:
      #   - $ref: "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
      type: object
      properties:
        # NGSI-LD Required Properties
        id:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Unique identifier of the charging point status entity
          x-ngsi:
            type: Property
        
        type:
          description: NGSI Entity type. It has to be ChargingPointStatus
          enum:
            - ChargingPointStatus
          type: string
          x-ngsi:
            type: Property
        
        # Standard Common Properties
        dateCreated:
          description: Entity creation timestamp. This will usually be allocated by the storage platform
          format: date-time
          type: string
          x-ngsi:
            type: Property
        
        # Reference to Static Point
        refChargingPoint:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to the charging point this status belongs to
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship
        
        # Current Operational Status
        pointStatus:
          description: Current operational status of the charging point
          enum:
            - available
            - occupied
            - reserved
            - charging
            - finishing
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        # Real-time Operating Data
        operatingData:
          description: Current operating parameters of the point
          properties:
            currentPowerOutput:
              description: Current power output in kW
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kW
            currentVoltage:
              description: Current output voltage in V
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: V
            currentCurrent:
              description: Current output current in A
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: A
            powerFactor:
              description: Current power factor
              maximum: 1
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
            efficiency:
              description: Current operating efficiency percentage
              maximum: 100
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: percent
          type: object
          x-ngsi:
            model: https://schema.org/Object
            type: Property   
    
      required:
        - id
        - type
        - refChargingPoint
        - unitStatus
        - dateCreated
      
      # # Metadata
      # x-derived-from: "Smart Data Models - Transportation"
      # x-disclaimer: "Redistribution and use in source and binary forms, with or without modification, are permitted provided that the license conditions are met. Copyleft (c) 2024 Contributors to Smart Data Models Program"
      # x-license-url: "https://github.com/smart-data-models/dataModel.Transportation/blob/master/LICENSE.md"
      # x-model-schema: "https://smart-data-models.github.io/dataModel.Transportation/ChargingPointStatus/schema.json"
      # x-model-tags: "NGSI-LD, EV, Electric Vehicle, Charging, Point, Status, Dynamic"
      # x-version: "1.0.0"

    ChargingSession:
      description: 'E4C charging session represents a complete charging event for an electric vehicle, including session details, energy consumption, duration, and billing information'
      # allOf:
      #   - $ref: "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
      type: object
      properties:
        # NGSI-LD Required Properties
        id:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Unique identifier of the charging session entity
          x-ngsi:
            type: Property
        
        type:
          description: NGSI Entity type. It has to be ChargingSession
          enum:
            - ChargingSession
          type: string
          x-ngsi:
            type: Property
        
        # Standard Common Properties
        dateCreated:
          description: Entity creation timestamp. This will usually be allocated by the storage platform
          format: date-time
          type: string
          x-ngsi:
            type: Property
        
        # Relationships to Other Entities
        refVehicleStatus:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to the E-Vehicle Status that is being charged
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship
        
        refChargingPoint:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to the charging point being used for this session
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship
        
        # Session Basic Information
        sessionId:
          description: External session identifier from charging management system
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        sessionStatus:
          description: Current status of the charging session
          enum:
            - initiated
            - authorized
            - started
            - charging
            - suspended
            - ended
            - completed
            - failed
            - cancelled
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        sessionType:
          description: Type of charging session
          enum:
            - AC-Level1
            - AC-Level2
            - DC-FastCharging
            - bidirectional
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        # Timing Information
        sessionStartTime:
          description: Timestamp when the charging session was initiated
          format: date-time
          type: string
          x-ngsi:
            model: https://schema.org/DateTime
            type: Property
        
        sessionEndTime:
          description: Timestamp when the charging session ended
          format: date-time
          type: string
          x-ngsi:
            model: https://schema.org/DateTime
            type: Property
        
        chargingStartTime:
          description: Timestamp when actual charging (energy transfer) began
          format: date-time
          type: string
          x-ngsi:
            model: https://schema.org/DateTime
            type: Property
        
        chargingEndTime:
          description: Timestamp when actual charging (energy transfer) ended
          format: date-time
          type: string
          x-ngsi:
            model: https://schema.org/DateTime
            type: Property
        
        sessionDuration:
          description: Total session duration in minutes (from initiation to completion)
          minimum: 0
          type: number
          x-ngsi:
            model: https://schema.org/Number
            type: Property
            units: minutes
        
        chargingDuration:
          description: Actual charging duration in minutes (energy transfer time)
          minimum: 0
          type: number
          x-ngsi:
            model: https://schema.org/Number
            type: Property
            units: minutes
        
        # Energy Information
        energyDelivered:
          description: Total energy delivered during the session in kWh
          minimum: 0
          type: number
          x-ngsi:
            model: https://schema.org/Number
            type: Property
            units: kWh
        
        energyConsumed:
          description: Total energy consumed from the grid during the session in kWh
          minimum: 0
          type: number
          x-ngsi:
            model: https://schema.org/Number
            type: Property
            units: kWh
        
        averageChargingPower:
          description: Average charging power during the session in kW
          minimum: 0
          type: number
          x-ngsi:
            model: https://schema.org/Number
            type: Property
            units: kW
        
        maxChargingPower:
          description: Maximum charging power reached during the session in kW
          minimum: 0
          type: number
          x-ngsi:
            model: https://schema.org/Number
            type: Property
            units: kW
        
        chargingEfficiency:
          description: Overall charging efficiency as percentage
          maximum: 100
          minimum: 0
          type: number
          x-ngsi:
            model: https://schema.org/Number
            type: Property
            units: percent
        
        # Battery Information
        batteryStatusAtStart:
          description: Battery status when session started
          properties:
            stateOfCharge:
              description: Battery state of charge at session start (0-100)
              maximum: 100
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: percent
          type: object
          x-ngsi:
            model: https://schema.org/Object
            type: Property
        
        batteryStatusAtEnd:
          description: Battery status when session ended
          properties:
            stateOfCharge:
              description: Battery state of charge at session end (0-100)
              maximum: 100
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: percent
          type: object
          x-ngsi:
            model: https://schema.org/Object
            type: Property
        
        # User and Authentication Information
        userId:
          description: Identifier of the user who initiated the session
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        authenticationMethod:
          description: Method used to authenticate the charging session
          enum:
            - rfid
            - mobileApp
            - qrCode
            - nfc
            - web
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        authenticationId:
          description: Authentication identifier (RFID tag, user ID, etc.)
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        # Technical Information
        chargingProtocol:
          description: Communication protocol used for charging
          enum:
            - IEC61851
            - CHAdeMO
            - CCS
            - Tesla
            - GB/T
            - ISO15118
            - OCPP
            - other
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        
        # Session End Information
        endReason:
          description: Reason why the charging session ended
          enum:
            - completed
            - userStopped
            - batteryFull
            - timeLimit
            - powerLimit
            - emergency
            - error
            - maintenance
            - deAuthorized
            - other
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        # Session Quality and Performance
        sessionRating:
          description: User rating for the charging session (1-5)
          maximum: 5
          minimum: 1
          type: integer
          x-ngsi:
            model: https://schema.org/Number
            type: Property
        
        # Timestamps
        lastUpdated:
          description: Timestamp when data was last updated
          format: date-time
          type: string
          x-ngsi:
            model: https://schema.org/DateTime
            type: Property
      
      required:
        - id
        - type
        - refChargingPoint
        - sessionStatus
        - sessionStartTime
        - lastUpdated
      
      # # Metadata
      # x-derived-from: "Smart Data Models - Transportation"
      # x-disclaimer: "Redistribution and use in source and binary forms, with or without modification, are permitted provided that the license conditions are met. Copyleft (c) 2024 Contributors to Smart Data Models Program"
      # x-license-url: "https://github.com/smart-data-models/dataModel.Transportation/blob/master/LICENSE.md"
      # x-model-schema: "https://smart-data-models.github.io/dataModel.Transportation/ChargingSession/schema.json"
      # x-model-tags: "NGSI-LD, EV, Electric Vehicle, Charging, Session, Transportation"
      # x-version: "1.0.0"

    E-Vehicle:
      description: 'Static information and specifications for a E4C electric vehicle, including all properties which are common to the vehicle model and do not change frequently'
      # allOf:
      #   - $ref: "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
      type: object
      properties:
        # NGSI-LD Required Properties
        id:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Unique identifier of the electric vehicle entity
          x-ngsi:
            type: Property
        
        type:
          description: NGSI Entity type. It has to be E-Vehicle
          enum:
            - E-Vehicle
          type: string
          x-ngsi:
            type: Property
        
        # Standard Common Properties   
        dateCreated:
          description: Entity creation timestamp. This will usually be allocated by the storage platform
          format: date-time
          type: string
          x-ngsi:
            type: Property

        # Timestamps
        lastUpdated:
          description: Timestamp when data was last updated
          format: date-time
          type: string
          x-ngsi:
            model: https://schema.org/DateTime
            type: Property
        
        # Vehicle Basic Information   
        vehiclePlateIdentifier:
          description: 'An identifier or code displayed on a vehicle registration plate attached to the vehicle used for official identification purposes'
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
        
        brand:
          description: Vehicle brand or manufacturer
          type: string
          x-ngsi:
            model: https://schema.org/brand
            type: Property
          
        color:
          description: The color of the vehicle
          type: string
          x-ngsi:
            model: https://schema.org/color
            type: Property
        
        # Electric Vehicle Specifications
        batterySpecifications:
          description: Battery system specifications
          properties:
            totalCapacity:
              description: Total battery capacity in kWh
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kWh
            batteryType:
              description: Type of battery technology
              enum:
                - lithium-ion
                - lithium-polymer
                - nickel-metal-hydride
                - solid-state
                - other
              type: string
              x-ngsi:
                model: https://schema.org/Text
                type: Property
            nominalVoltage:
              description: Nominal battery voltage in Volts
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: V
          type: object
          x-ngsi:
            model: https://schema.org/Object
            type: Property

        chargingCapabilities:
          description: Charging system capabilities and specifications
          properties:
            maxChargingPowerAC:
              description: Maximum AC charging power supported by the vehicle in kW
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kW
            maxChargingPowerDC:
              description: Maximum DC charging power supported by the vehicle in kW
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kW
            chargingPortTypes:
              description: Types of charging ports available on the vehicle
              items:
                enum:
                  - CCS1
                  - CCS2
                  - CHAdeMO
                  - Type1
                  - Type2
                  - Tesla
                  - GBT
                  - NACS
                type: string
              type: array
              x-ngsi:
                model: https://schema.org/Text
                type: Property
            chargingStandards:
              description: Charging standards supported by the vehicle
              items:
                enum:
                  - AC-Level1
                  - AC-Level2
                  - DC-FastCharging
                  - bidirectional
                type: string
              type: array
              x-ngsi:
                model: https://schema.org/Text
                type: Property
          type: object
          x-ngsi:
            model: https://schema.org/Object
            type: Property
          
        # Relationships to e-VehicleStatus
        refVehicleStatus:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to current VehicleS tatus
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship
        
        vehicleType:
          description: 'Type of vehicle from the point of view of its structural characteristics'
          enum:
            - car
            - van
            - motorcycle
          type: string
          x-ngsi:
            model: https://schema.org/Text
            type: Property
      
      required:
        - id
        - type
        - brand
        - vehiclePlateIdentifier
        - batterySpecifications
        - chargingCapabilities
        - refVehicleStatus
        - vehicleType
      
      # # Metadata
      # x-derived-from: "Smart Data Models - Transportation"
      # x-disclaimer: "Redistribution and use in source and binary forms, with or without modification, are permitted provided that the license conditions are met. Copyleft (c) 2024 Contributors to Smart Data Models Program"
      # x-license-url: "https://github.com/smart-data-models/dataModel.Transportation/blob/master/LICENSE.md"
      # x-model-schema: "https://smart-data-models.github.io/dataModel.Transportation/E-Vehicle/schema.json"
      # x-model-tags: "NGSI-LD, EV, Electric Vehicle, Transportation, Static Data"
      # x-version: "1.0.0"

    E-VehicleStatus:
      description: 'Real-time operational status and dynamic data for E4C electric vehicle, including battery status, location, charging state, and other frequently changing properties'
      # allOf:
      #   - $ref: "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
      type: object
      properties:
        # NGSI-LD Required Properties
        id:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Unique identifier of the electric vehicle status entity
          x-ngsi:
            type: Property
        
        type:
          description: NGSI Entity type. It has to be E-VehicleStatus
          enum:
            - E-VehicleStatus
          type: string
          x-ngsi:
            type: Property
        
        # Standard Common Properties  
        dateCreated:
          description: Entity creation timestamp. This will usually be allocated by the storage platform
          format: date-time
          type: string
          x-ngsi:
            type: Property

        # Reference to Parent Vehicle
        refVehicle:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to the E-Vehicle this status belongs to
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship
          
        # Battery Status
        batteryStatus:
          description: Current battery status and health information
          properties:
            stateOfCharge:
              description: Current battery state of charge as percentage (0-100)
              maximum: 100
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: percent
            batteryVoltage:
              description: Current battery pack voltage in Volts
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: V
            batteryCurrent:
              description: Current battery pack current in Amperes (positive for discharge, negative for charge)
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: A
            batteryPower:
              description: Current battery power in kW (positive for discharge, negative for charge)
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kW
            stateOfHealth:
              description: Battery state of health as percentage (0-100)
              maximum: 100
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: percent
            cycleCount:
              description: Number of charge/discharge cycles completed
              minimum: 0
              type: integer
              x-ngsi:
                model: https://schema.org/Number
                type: Property
            timeToEmpty:
              description: Estimated time until battery is empty in minutes
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: minutes
            timeToFull:
              description: Estimated time until battery is fully charged in minutes (only when charging)
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: minutes
          type: object
          x-ngsi:
            model: https://schema.org/Object
            type: Property
        
        # Range Information
        batteryRangeStatus:
          description: Real-time status about driving range, focused on charging/discharging scenarios
          properties:
            currentRange:
              description: Current estimated driving range with present battery level in kilometers
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: km
            rangeAtFullCharge:
              description: Maximum driving range when battery reaches 100% SoC in kilometers
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: km
            energyConsumptionRate:
              description: Real-time energy consumption rate in kWh per 100km
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kWh/100km

        # Charging Status
        chargingStatus:
          description: Current charging status and information
          properties:
            isCharging:
              description: Whether the vehicle is currently charging
              type: boolean
              x-ngsi:
                model: https://schema.org/Boolean
                type: Property
            chargingState:
              description: Current charging state
              enum:
              - initiated
              - authorized
              - started
              - charging
              - suspended
              - ended
              - completed
              - failed
              - cancelled
              type: string
              x-ngsi:
                model: https://schema.org/Text
                type: Property
            chargingMode:
              description: Current charging mode
              enum:
                - AC-Level1
                - AC-Level2
                - DC-FastCharging
                - bidirectional
              type: string
              x-ngsi:
                model: https://schema.org/Text
                type: Property
            chargingPower:
              description: Current charging power in kW
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kW
            chargingVoltage:
              description: Current charging voltage in Volts
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: V
            chargingCurrent:
              description: Current charging current in Amperes
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: A
            chargingEfficiency:
              description: Current charging efficiency as percentage
              maximum: 100
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: percent
            energyConsumed:
              description: Total energy consumed during current charging session in kWh
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: kWh
            chargingStartTime:
              description: Timestamp when current charging session started
              format: date-time
              type: string
              x-ngsi:
                model: https://schema.org/DateTime
                type: Property
            estimatedChargingTime:
              description: Estimated remaining charging time in minutes
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: minutes
            targetStateOfCharge:
              description: Target state of charge for current charging session
              maximum: 100
              minimum: 0
              type: number
              x-ngsi:
                model: https://schema.org/Number
                type: Property
                units: percent
          type: object
          x-ngsi:
            model: https://schema.org/Object
            type: Property
        
        # Relationships to Charging Infrastructure
        refChargingSession:
          anyOf:
            - description: Identifier format of any NGSI entity
              maxLength: 256
              minLength: 1
              pattern: ^[\w\-\.\{\}\$\+\*\[\]`|~^@!,:\\]+$
              type: string
            - description: Identifier format of any NGSI entity
              format: uri
              type: string
          description: Reference to current charging session if vehicle is currently charging
          x-ngsi:
            model: https://schema.org/URL
            type: Relationship
          
      required:
        - id
        - type
        - refVehicle
        - batteryStatus
        - dateCreated

      
      # # Metadata
      # x-derived-from: "Smart Data Models - Transportation"
      # x-disclaimer: "Redistribution and use in source and binary forms, with or without modification, are permitted provided that the license conditions are met. Copyleft (c) 2024 Contributors to Smart Data Models Program"
      # x-license-url: "https://github.com/smart-data-models/dataModel.Transportation/blob/master/LICENSE.md"
      # x-model-schema: "https://smart-data-models.github.io/dataModel.Transportation/E-VehicleStatus/schema.json"
      # x-model-tags: "NGSI-LD, EV, Electric Vehicle, Transportation, Dynamic Data, Real-time"
      # x-version: "1.0.0"